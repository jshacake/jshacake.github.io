---
title:  "DES 구현일지"
excerpt: "C언어로 DES를 구현해보려 한다."

categories:
  - Blog
tags:
  - Blog
last_modified_at: 2021-03-19T08:06:00-05:00
---

## Objective

1. DES의 Encryption, Decryption, Key Schedule을 구현한다.
2. 블록암호 모드를 구현한다.
3. 파일 입출력 시 파일을 보호해본다.
4. (가능하다면) Cryptanalysis 시도해본다.



## What's going on

- 18 Mar 2021

  - Initial Permutation을 구현하는 방법을 생각해냈다.

  ```c
  void initial_permutation(unsigned char r[8])
  {
  	r[0] |= ( ( p[7] >> 6 ) & 1 ) << 7;
  	r[0] |= ( ( p[6] >> 6 ) & 1 ) << 6;
  	r[0] |= ( ( p[5] >> 6 ) & 1 ) << 5;
  	r[0] |= ( ( p[4] >> 6 ) & 1 ) << 4;
  	r[0] |= ( ( p[3] >> 6 ) & 1 ) << 3;
  	r[0] |= ( ( p[2] >> 6 ) & 1 ) << 2;
  	r[0] |= ( ( p[1] >> 6 ) & 1 ) << 1;
  	r[0] |= ( ( p[0] >> 6 ) & 1 );
  	
  	r[1] |= ( ( p[7] >> 4 ) & 1 ) << 7;
  	r[1] |= ( ( p[6] >> 4 ) & 1 ) << 6;
  	r[1] |= ( ( p[5] >> 4 ) & 1 ) << 5;
  	r[1] |= ( ( p[4] >> 4 ) & 1 ) << 4;
  	r[1] |= ( ( p[3] >> 4 ) & 1 ) << 3;
  	r[1] |= ( ( p[2] >> 4 ) & 1 ) << 2;
  	r[1] |= ( ( p[1] >> 4 ) & 1 ) << 1;
  	r[1] |= ( ( p[0] >> 4 ) & 1 );
  	
  	r[2] |= ( ( p[7] >> 2 ) & 1 ) << 7;
  	r[2] |= ( ( p[6] >> 2 ) & 1 ) << 6;
  	r[2] |= ( ( p[5] >> 2 ) & 1 ) << 5;
  	r[2] |= ( ( p[4] >> 2 ) & 1 ) << 4;
  	r[2] |= ( ( p[3] >> 2 ) & 1 ) << 3;
  	r[2] |= ( ( p[2] >> 2 ) & 1 ) << 2;
  	r[2] |= ( ( p[1] >> 2 ) & 1 ) << 1;
  	r[2] |= ( ( p[0] >> 2 ) & 1 );
  	
  	r[3] |= ( ( p[7] >> 0 ) & 1 ) << 7;
  	r[3] |= ( ( p[6] >> 0 ) & 1 ) << 6;
  	r[3] |= ( ( p[5] >> 0 ) & 1 ) << 5;
  	r[3] |= ( ( p[4] >> 0 ) & 1 ) << 4;
  	r[3] |= ( ( p[3] >> 0 ) & 1 ) << 3;
  	r[3] |= ( ( p[2] >> 0 ) & 1 ) << 2;
  	r[3] |= ( ( p[1] >> 0 ) & 1 ) << 1;
  	r[3] |= ( ( p[0] >> 0 ) & 1 );
  	
  	r[4] |= ( ( p[7] >> 7 ) & 1 ) << 7;
  	r[4] |= ( ( p[6] >> 7 ) & 1 ) << 6;
  	r[4] |= ( ( p[5] >> 7 ) & 1 ) << 5;
  	r[4] |= ( ( p[4] >> 7 ) & 1 ) << 4;
  	r[4] |= ( ( p[3] >> 7 ) & 1 ) << 3;
  	r[4] |= ( ( p[2] >> 7 ) & 1 ) << 2;
  	r[4] |= ( ( p[1] >> 7 ) & 1 ) << 1;
  	r[4] |= ( ( p[0] >> 7 ) & 1 );
  	
  	r[5] |= ( ( p[7] >> 5 ) & 1 ) << 7;
  	r[5] |= ( ( p[6] >> 5 ) & 1 ) << 6;
  	r[5] |= ( ( p[5] >> 5 ) & 1 ) << 5;
  	r[5] |= ( ( p[4] >> 5 ) & 1 ) << 4;
  	r[5] |= ( ( p[3] >> 5 ) & 1 ) << 3;
  	r[5] |= ( ( p[2] >> 5 ) & 1 ) << 2;
  	r[5] |= ( ( p[1] >> 5 ) & 1 ) << 1;
  	r[5] |= ( ( p[0] >> 5 ) & 1 );
  	
  	r[6] |= ( ( p[7] >> 3 ) & 1 ) << 7;
  	r[6] |= ( ( p[6] >> 3 ) & 1 ) << 6;
  	r[6] |= ( ( p[5] >> 3 ) & 1 ) << 5;
  	r[6] |= ( ( p[4] >> 3 ) & 1 ) << 4;
  	r[6] |= ( ( p[3] >> 3 ) & 1 ) << 3;
  	r[6] |= ( ( p[2] >> 3 ) & 1 ) << 2;
  	r[6] |= ( ( p[1] >> 3 ) & 1 ) << 1;
  	r[6] |= ( ( p[0] >> 3 ) & 1 );
  	
  	r[7] |= ( ( p[7] >> 1 ) & 1 ) << 7;
  	r[7] |= ( ( p[6] >> 1 ) & 1 ) << 6;
  	r[7] |= ( ( p[5] >> 1 ) & 1 ) << 5;
  	r[7] |= ( ( p[4] >> 1 ) & 1 ) << 4;
  	r[7] |= ( ( p[3] >> 1 ) & 1 ) << 3;
  	r[7] |= ( ( p[2] >> 1 ) & 1 ) << 2;
  	r[7] |= ( ( p[1] >> 1 ) & 1 ) << 1;
  	r[7] |= ( ( p[0] >> 1 ) & 1 );
  	
  }
  ```

  

  - Skeleton Code를 전부 적어놓고 하는 편이 나을 것 같다고 생각했다.
  - 함수 인자에 대해 좀 고민해보고 설계해야겠다.